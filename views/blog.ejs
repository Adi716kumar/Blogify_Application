<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/head') %>
    <title>Blog</title>
    <style>
  :root{
    --bg1:#0f172a;
    --bg2:#0b1220;
    --accent1:#7c3aed;
    --accent2:#06b6d4;
    --glass:rgba(255,255,255,.06);
    --muted:rgba(255,255,255,.7);
  }

  html,body{
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:#e5e7eb;
    font-family:Inter,ui-sans-serif,system-ui;
  }

  .container{
    max-width:820px;
  }

  /* Author section */
  .author-bar{
    display:flex;
    align-items:center;
    gap:12px;
    margin:40px auto 20px;
  }

  .profile-img{
    width:54px;
    height:54px;
    border-radius:50%;
    object-fit:cover;
    border:2px solid var(--accent1);
  }

  .author-name{
    font-size:18px;
    font-weight:600;
    color:#fff;
  }

  /* Blog card */
  .blog-card{
    background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));
    border-radius:16px;
    border:1px solid rgba(255,255,255,.05);
    box-shadow:0 20px 50px rgba(2,6,23,.7);
    overflow:hidden;
  }

  .card-img-top{
    max-height:380px;
    object-fit:cover;
  }

  .card-body{
    padding:28px;
  }

  .card-title{
    font-size:32px;
    font-weight:700;
    line-height:1.3;
    margin-bottom:18px;
    color:#fff;
  }

  .blog-body{
    white-space:pre-wrap;
    line-height:1.75;
    font-size:16px;
    color:#dbeafe;
  }

  /* Action buttons */
  .blog-actions{
    display:flex;
    justify-content:space-between;
    margin-top:24px;
  }

  .btn-edit{
    background:linear-gradient(90deg,var(--accent1),var(--accent2));
    border:none;
    padding:8px 18px;
    border-radius:10px;
    color:white;
    font-weight:600;
  }

  .btn-delete{
    background:transparent;
    border:1px solid rgba(255,255,255,.2);
    padding:8px 18px;
    border-radius:10px;
    color:#fca5a5;
  }

  .btn-delete:hover{
    background:rgba(239,68,68,.15);
  }

  /* Comments */
  .comments-title{
    margin:40px 0 20px;
    font-size:26px;
    font-weight:700;
    color:#fff;
  }

  .comment-card{
    background:var(--glass);
    border-radius:14px;
    padding:16px;
    border:1px solid rgba(255,255,255,.04);
    margin-bottom:14px;
  }

  .comment-header{
    display:flex;
    align-items:center;
    gap:10px;
    margin-bottom:6px;
  }

  .comment-img{
    width:36px;
    height:36px;
    border-radius:50%;
    object-fit:cover;
    border:2px solid var(--accent2);
  }

  .comment-text{
    font-size:15px;
    color:#e5e7eb;
    margin-left:46px;
  }

  /* Add comment */
  .comment-form{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
  border-radius:16px;
  padding:22px;
  border:1px solid rgba(255,255,255,0.05);
  box-shadow:0 14px 40px rgba(2,6,23,0.6);
}

.comment-title{
  margin-bottom:14px;
  font-size:18px;
  font-weight:600;
  color:#fff;
}

.comment-label{
  font-size:14px;
  color:var(--muted);
  margin-bottom:6px;
  display:block;
}

.comment-input{
  width:100%;
  background:var(--glass);
  border:1px solid rgba(255,255,255,0.08);
  border-radius:12px;
  padding:12px 14px;
  color:#fff;
  outline:none;
  font-size:15px;
  line-height:1.6;
  resize:vertical;
}

.comment-input::placeholder{
  color:rgba(255,255,255,0.45);
}

.comment-input:focus{
  border-color:var(--accent2);
  box-shadow:0 0 0 2px rgba(6,182,212,0.25);
}

.btn-comment{
  margin-top:10px;
  background: linear-gradient(90deg,var(--accent1),var(--accent2));
  border:none;
  padding:10px 22px;
  border-radius:12px;
  color:white;
  font-weight:600;
  cursor:pointer;
  box-shadow:0 10px 30px rgba(124,58,237,0.25);
  transition:transform .18s, box-shadow .18s;
}

.btn-comment:hover{
  transform:translateY(-2px);
  box-shadow:0 18px 40px rgba(6,182,212,0.2);
}


</style>

</head>
<body>
    <%- include('partials/nav') %>
    
<div class="author-bar container">
  <img src="<%= blog.createdBy?.profileImageURL || '/images/default.png' %>" class="profile-img">
  <div class="author-name">
    <%= blog.authorSnapshot?.name || "Unknown Author" %>
  </div>
</div>


    <div class="container mt-3">
  <div class="blog-card">
            <% if(blog.coverImageURL){ %>
                <img src="<%= blog.coverImageURL %>" class="card-img-top" alt="Cover Image">
            <% } %>
            <div class="card-body">
                <h3 class="card-title"><%= blog.title %></h3>
                <pre><%= blog.body %></pre>
                 <% if (user && blog.createdBy && user.id === blog.createdBy._id.toString()) { %>
                    <div class="blog-actions">
  <form action="/blog/delete/<%= blog._id %>" method="POST">
    <button class="btn-delete">Delete</button>
  </form>

  <a href="/blog/edit/<%= blog._id %>" class="btn-edit">Edit</a>
</div>

                    <% } %>
            </div>
        </div>
    </div>

   


    <div class="container mt-3">
        <h1>Comments</h1>
       <% if (locals.comments) { %>
        <% comments.forEach(function(comment) { %>
             <div class="comment-card">
  <div class="comment-header">
    <img src="<%= comment.authorSnapshot.profileImageURL || '/images/default.png' %>" class="comment-img">
    <strong><%= comment.authorSnapshot.name %></strong>
  </div>
  <p class="comment-text"><%= comment.content %></p>
</div>

       <% }) %>
       <% } else { %>
        <p>No comments yet. Be the first to comment!</p>    
         <% } %>

        <% if(locals.user) { %>
                        <form 
                action="/blog/comment/<%= blog._id %>" 
                method="post" 
                class="comment-form mt-4">

                <h5 class="comment-title">Add a Comment</h5>

                <div class="mb-3">
                    <label class="comment-label">Comment</label>
                    <textarea 
                    name="content"
                    rows="4"
                    class="comment-input"
                    placeholder="Write your comment..."
                    required></textarea>
                </div>

                <button type="submit" class="btn-comment">
                    Post Comment
                </button>
                </form>

        <% } %>
    </div>
    <%- include('partials/scripts') %>
</body>
</html>